define("maps",["ol","proj4"],function(e,t){function o(){t.defs("EPSG:32758","+proj=utm +zone=58 +south +datum=WGS84 +units=m +no_defs");var o="http://carto.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer",n="map",i=new e.View({projection:"EPSG:4326",center:new e.proj.transform([165.875,-21.145],"EPSG:4326","EPSG:4326"),zoom:7.5}),r=new e.control.Attribution({collapsible:!1}),a=new e.Map({target:n,layers:[new e.layer.Tile({source:new e.source.TileWMS({url:o,params:{LAYERS:"0",FORMAT:"image/png",CRS:"EPSG:32758"},serverType:"mapserver",attributions:[new e.Attribution({html:'<a href="http://georep.nc/">Géorep</a> - <em>Gouvernement de la Nouvelle-Calédonie</em>'})]})})],view:i,controls:[new e.control.Zoom,r]});return a}function n(t,o){var n=o||{},i=n.image_vector,r=new e.source.Vector({features:(new e.format.GeoJSON).readFeatures(t)});return n.source=r,i?new e.layer.Image({source:new e.source.ImageVector(n)}):new e.layer.Vector(n)}function i(t){var o=t.positioning,n=t.autoPan,i=t.autoPanAnimation;this.hide_callback=t.hide_callback,this.show_callback=t.show_callback,this.popup_element=document.createElement("div"),this.popup_element.className="olext-popup",this.popup_title=document.createElement("p"),this.popup_title.className="olext-popup-title",this.popup_closer=document.createElement("a"),this.popup_closer.className="olext-popup-closer",this.popup_closer.href="#",this.popup_content=document.createElement("div"),this.popup_content.className="olext-popup-content",this.popup_element.appendChild(this.popup_closer),this.popup_element.appendChild(this.popup_title),this.popup_element.appendChild(this.popup_content);var r=this;this.popup_closer.addEventListener("click",function(e){r.setPosition(void 0),r.hide_callback&&r.hide_callback()}),e.Overlay.call(this,{element:this.popup_element,positioning:o,autoPan:n,autoPanAnimation:i})}return e.inherits(i,e.Overlay),i.prototype.show=function(e,t,o,n){return this.popup_title.innerHTML=t,this.popup_content.innerHTML=o,this.setPosition(e),n?n():this.show_callback&&this.show_callback(),this},i.prototype.hide=function(e){return this.setPosition(void 0),e?e():this.hide_callback&&this.hide_callback(),this},i.prototype.setTitle=function(e){this.popup_title.innerHTML=e},i.prototype.setContent=function(e){this.popup_content.innerHTML=e},{getDefaultMap:o,makeGeoJSONLayer:n,Popup:i}}),require(["jquery","ol","maps"],function(e,t,o){function n(){document.getElementById("preloader").style.display="none"}var i=o.getDefaultMap();e(document).ready(function(){function r(e,n,r){var s=o.makeGeoJSONLayer(e,{style:new t.style.Style({image:new t.style.Circle({radius:5,fill:new t.style.Fill({color:n}),stroke:new t.style.Stroke({color:r,width:1})})})});i.addLayer(s);var l=new t.interaction.Select({condition:t.events.condition.pointerMove,layers:[s],updateWhileInteracting:!0,style:new t.style.Style({image:new t.style.Circle({radius:6,fill:new t.style.Fill({color:"#66a3ff"}),stroke:new t.style.Stroke({color:"#cce0ff",width:2})})})});i.addInteraction(l),a(s)}function a(n){var r=new o.Popup({positioning:"bottom-center",autoPan:!0,autoPanAnimation:{duration:250}});i.addOverlay(r);var a=new t.interaction.Select({condition:t.events.condition.click,layers:[n]});a.on("select",function(e){var t=a.getFeatures();if(t.getLength()>0){var o=t.item(0),n=o.getGeometry().getCoordinates(),i=o.get("observer_full_name"),s=o.get("inventory_date")+" - "+o.get("location_description");r.show(n,i,s)}else r.hide()}),e(".olext-popup-closer").click(function(){a.getFeatures().clear()}),i.addInteraction(a)}var s=0;e.ajax({type:"GET",url:rapid_inventories_url,success:function(e){var t=e.results;r(t,"#e2bc15","#fff1ae"),s+=1,2==s&&n()}}),e.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.addEventListener("progress",function(e){if(e.lengthComputable){var t=(e.loaded/e.total*100).toFixed(1);progress_bar.setValue(t),progress_bar.setLabel(t+"%")}},!1),e},type:"GET",url:taxa_inventories_url,success:function(e){var t=e.results;r(t,"#e25515","#d67f57"),s+=1,2==s&&n()}})})}),define("homepage",function(){});