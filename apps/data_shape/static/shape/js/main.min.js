(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.showPreloader=showPreloader;exports.hidePreloader=hidePreloader;function showPreloader(){document.getElementById("preloader").style.display="inline"}function hidePreloader(){document.getElementById("preloader").style.display="none"}},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.taxonTreeList=exports.taxonList=exports.shapeLocation=exports.shapeList=exports.plotList=void 0;var host=window.location.host;var protocol=window.location.protocol;var apiRoot=protocol+"//"+host+"/api/1.0";var plotList=apiRoot+"/Plot/";exports.plotList=plotList;var shapeList=apiRoot+"/Shape/";exports.shapeList=shapeList;var shapeLocation=apiRoot+"/ShapeLocation/";exports.shapeLocation=shapeLocation;var taxonList=apiRoot+"/Taxon/";exports.taxonList=taxonList;var taxonTreeList=apiRoot+"/TaxonTree/";exports.taxonTreeList=taxonTreeList},{}],3:[function(require,module,exports){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var restUrls=_interopRequireWildcard(require("../restUrls"));var preloader=_interopRequireWildcard(require("../preloader"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj)}return newObj}var shapeList=restUrls.shapeList;var shapeLocation=restUrls.shapeLocation;var wmsUrlNC="http://carto.gouv.nc/arcgis/services/fond_imagerie/"+"MapServer/WMSServer";var layerBackground=new ol.layer.Tile({source:new ol.source.TileWMS({url:wmsUrlNC,params:{LAYERS:"0",TILED:true,FORMAT:"image/png"},serverType:"mapserver"})});var features=new ol.Collection;var source=new ol.source.Vector({features:features});var layerShape=new ol.layer.Vector({source:source});var view=new ol.View({projection:"EPSG:4326",center:new ol.proj.transform([165.875,-21.145],"EPSG:4326","EPSG:4326"),zoom:6});var map=new ol.Map({target:"mapCaledonie",view:view});map.addLayer(layerBackground);map.addLayer(layerShape);function buildShapeList(){var shapes={};$.ajax({type:"GET",data:{ordering:"label"},url:shapeList,success:function success(result){shapes=result.reduce(function(map,obj){map[obj.id]=obj;return map},{});var typeShape="";var select=document.getElementById("shape_select");var optgrp=document.createElement("optgroup");for(var idx in shapes){var option=document.createElement("option");if(typeShape!==shapes[idx].typeShape){optgrp=document.createElement("optgroup");typeShape=shapes[idx].typeShape;optgrp.label=typeShape;select.add(optgrp)}option.text=shapes[idx].label;option.value=shapes[idx].id;optgrp.append(option)}$("#shape_select").selectpicker({noneSelectedText:"Selectionnez une emprise"});$("#shape_select").selectpicker("val",null);$("#shape_select").change(function(){preloader.showPreloader();updateData(shapes[this.value])});preloader.hidePreloader()}})}function updateData(shape){$.ajax({type:"GET",url:shapeList+shape.id+"/",success:function success(response){$("#shape_select").trigger("shapeSelected",response);updateLayerShape(response);preloader.hidePreloader()}})}function updateLayerShape(data){source.clear();source.addFeature((new ol.format.GeoJSON).readFeature(data));var feature=source.getFeatures()[0];var polygon=feature.getGeometry();view.fit(polygon,{padding:[5,5,5,5]})}document.addEventListener("DOMContentLoaded",function(){$("#preloader").on("elementLoaded",function(event,data){preloader.hidePreloader()});buildShapeList()})},{"../preloader":1,"../restUrls":2}]},{},[3]);
