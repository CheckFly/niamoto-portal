(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.showPreloader=showPreloader;exports.hidePreloader=hidePreloader;function showPreloader(){document.getElementById("preloader").style.display="inline"}function hidePreloader(){document.getElementById("preloader").style.display="none"}},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.taxonTreeList=exports.taxonList=exports.shapeList=exports.plotList=void 0;var host=window.location.host;var protocol=window.location.protocol;var apiRoot=protocol+"//"+host+"/api/1.0";var plotList=apiRoot+"/Plot/";exports.plotList=plotList;var shapeList=apiRoot+"/Shape/";exports.shapeList=shapeList;var taxonList=apiRoot+"/Taxon/";exports.taxonList=taxonList;var taxonTreeList=apiRoot+"/TaxonTree/";exports.taxonTreeList=taxonTreeList},{}],3:[function(require,module,exports){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}var restUrls=_interopRequireWildcard(require("../restUrls"));var preloader=_interopRequireWildcard(require("../preloader"));var _taxonomy=require("./taxonomy");function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj)}return newObj}var TreeView=require("treeview");var taxonTreeList=restUrls.taxonTreeList;function buildTaxonList(){var taxons={};$.ajax({type:"GET",url:taxonTreeList,success:function success(result){var tree=new TreeView(result,"taxon_treeview","list-group-item");$("#taxon_treeview").on("select",function(){});preloader.hidePreloader()}})}function updateData(taxon){$.ajax({type:"GET",url:restUrls.taxonList+taxon.id+"/",success:function success(response){$("#taxon_select").trigger("taxonSelected",response);preloader.hidePreloader()}})}function makeNode(node){node.text=node.rank_name;node.icon="fas";node.state={expanded:false}}function makeLeaf(node){node.icon=""}document.addEventListener("DOMContentLoaded",function(){$("#preloader").on("elementLoaded",function(event,data){preloader.hidePreloader()});(0,_taxonomy.getTaxaTree)(function(taxaTree){$("#taxon_treeview").treeview({data:taxaTree,expandIcon:"fas fa-plus",collapseIcon:"fas fa-minus",emptyIcon:"fas",nodeIcon:"",selectedIcon:"",selectedBackColor:"#688BA5",onNodeSelected:function onNodeSelected(event,node){updateData(node)}});preloader.hidePreloader()},{make_node:makeNode,make_leaf:makeLeaf})})},{"../preloader":1,"../restUrls":2,"./taxonomy":5,treeview:4}],4:[function(require,module,exports){(function(define){"use strict";(function(root,factory){if(typeof define==="function"&&define.amd){define(factory)}else if(typeof exports==="object"){module.exports=factory()}else{root.TreeView=factory()}})(window,function(){return function(){var events=["expand","expandAll","collapse","collapseAll","select"];function isDOMElement(obj){try{return obj instanceof HTMLElement}catch(e){return typeof obj==="object"&&obj.nodeType===1&&typeof obj.style==="object"&&typeof obj.ownerDocument==="object"}}function forEach(arr,callback,scope){var i;var len=arr.length;for(i=0;i<len;i+=1){callback.call(scope,arr[i],i)}}function emit(instance,name){var args=[].slice.call(arguments,2);if(events.indexOf(name)>-1){if(instance.handlers[name]&&instance.handlers[name]instanceof Array){forEach(instance.handlers[name],function(handle){window.setTimeout(function(){handle.callback.apply(handle.context,args)},0)})}}else{throw new Error(name+" event cannot be found on TreeView.")}}function render(self){var container=isDOMElement(self.node)?self.node:document.getElementById(self.node);var leaves=[];var click;var renderLeaf=function(item){var leaf=document.createElement("div");var content=document.createElement("div");var text=document.createElement("div");var expando=document.createElement("div");leaf.setAttribute("class","tree-leaf "+self.classItem);content.setAttribute("class","tree-leaf-content");content.setAttribute("data-item",JSON.stringify(item));text.setAttribute("class","tree-leaf-text");text.textContent=item.rank_name;expando.setAttribute("class","tree-expando "+(item.expanded?"expanded":""));expando.textContent=item.expanded?"-":"+";content.appendChild(expando);content.appendChild(text);leaf.appendChild(content);if(item.children&&item.children.length>0){var children=document.createElement("div");children.setAttribute("class","tree-child-leaves");forEach(item.children,function(child){var childLeaf=renderLeaf(child);children.appendChild(childLeaf)});if(!item.expanded){children.classList.add("hidden")}leaf.appendChild(children)}else{expando.classList.add("hidden")}return leaf};forEach(self.data,function(item){leaves.push(renderLeaf.call(self,item))});container.innerHTML=leaves.map(function(leaf){return leaf.outerHTML}).join("");click=function(e){var parent=(e.target||e.currentTarget).parentNode;var data=JSON.parse(parent.getAttribute("data-item"));var leaves=parent.parentNode.querySelector(".tree-child-leaves");if(leaves){if(leaves.classList.contains("hidden")){self.expand(parent,leaves)}else{self.collapse(parent,leaves)}}else{emit(self,"select",{target:e,data:data})}};forEach(container.querySelectorAll(".tree-leaf-text"),function(node){node.onclick=click});forEach(container.querySelectorAll(".tree-expando"),function(node){node.onclick=click})}function TreeView(data,node,classItem){this.handlers={};this.node=node;this.data=data;this.classItem=classItem;render(this)}TreeView.prototype.expand=function(node,leaves,skipEmit){var expando=node.querySelector(".tree-expando");expando.textContent="-";leaves.classList.remove("hidden");if(skipEmit){return}emit(this,"expand",{target:node,leaves:leaves})};TreeView.prototype.expandAll=function(){var self=this;var nodes=document.getElementById(self.node).querySelectorAll(".tree-expando");forEach(nodes,function(node){var parent=node.parentNode;var leaves=parent.parentNode.querySelector(".tree-child-leaves");if(parent&&leaves&&parent.hasAttribute("data-item")){self.expand(parent,leaves,true)}});emit(this,"expandAll",{})};TreeView.prototype.collapse=function(node,leaves,skipEmit){var expando=node.querySelector(".tree-expando");expando.textContent="+";leaves.classList.add("hidden");if(skipEmit){return}emit(this,"collapse",{target:node,leaves:leaves})};TreeView.prototype.collapseAll=function(){var self=this;var nodes=document.getElementById(self.node).querySelectorAll(".tree-expando");forEach(nodes,function(node){var parent=node.parentNode;var leaves=parent.parentNode.querySelector(".tree-child-leaves");if(parent&&leaves&&parent.hasAttribute("data-item")){self.collapse(parent,leaves,true)}});emit(this,"collapseAll",{})};TreeView.prototype.on=function(name,callback,scope){if(events.indexOf(name)>-1){if(!this.handlers[name]){this.handlers[name]=[]}this.handlers[name].push({callback:callback,context:scope})}else{throw new Error(name+" is not supported by TreeView.")}};TreeView.prototype.off=function(name,callback){var index;var found=false;if(this.handlers[name]instanceof Array){this.handlers[name].forEach(function(handle,i){index=i;if(handle.callback===callback&&!found){found=true}});if(found){this.handlers[name].splice(index,1)}}};return TreeView}()})})(window.define)},{}],5:[function(require,module,exports){"use strict";function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}Object.defineProperty(exports,"__esModule",{value:true});exports.getTaxaTree=getTaxaTree;var restUrls=_interopRequireWildcard(require("../restUrls"));function _getRequireWildcardCache(){if(typeof WeakMap!=="function")return null;var cache=new WeakMap;_getRequireWildcardCache=function _getRequireWildcardCache(){return cache};return cache}function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{default:obj}}var cache=_getRequireWildcardCache();if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj)}return newObj}function getTaxaTreeFromTaxaList(taxa_list,options){options=options||{};var id_attr=options.id_attr||"id";var make_node=options.make_node||null;var parent_attr=options.parent_attr||"parent_id";var nodes_attr=options.nodes_attr||"nodes";var make_leaf=options.make_leaf||null;var tax_dict={};var tree=[];for(var i=0;i<taxa_list.length;i++){var taxon=taxa_list[i];taxon[nodes_attr]=[];if(make_node!=null){make_node(taxon)}tax_dict[taxon[id_attr]]=taxon}for(var tax_id in tax_dict){var tax=tax_dict[tax_id];if(tax[parent_attr]!=null){tax_dict[tax[parent_attr]][nodes_attr].push(tax)}}for(var i=0;i<taxa_list.length;i++){var tax=tax_dict[taxa_list[i][id_attr]];if(tax[nodes_attr].length==0){tax[nodes_attr]=null;if(make_leaf!=null){make_leaf(tax)}}if(tax[parent_attr]==null){tree.push(tax)}}return tree}function getTaxaTree(_success,options){$.ajax({type:"GET",url:restUrls.taxonList,success:function success(result){options=options||null;var taxaList=result;var taxaTree=getTaxaTreeFromTaxaList(taxaList,options);_success(taxaTree)}})}},{"../restUrls":2}]},{},[3]);
