define("maps",["ol","proj4"],function(e,t){function o(){t.defs("EPSG:32758","+proj=utm +zone=58 +south +datum=WGS84 +units=m +no_defs");var o="http://carto.gouv.nc/arcgis/services/fond_imagerie/MapServer/WMSServer",n="map",i=new e.View({projection:"EPSG:4326",center:new e.proj.transform([165.875,-21.145],"EPSG:4326","EPSG:4326"),zoom:7.5}),r=new e.Map({target:n,layers:[new e.layer.Tile({source:new e.source.TileWMS({url:o,params:{LAYERS:"0",FORMAT:"image/png",CRS:"EPSG:32758"},serverType:"mapserver"})})],view:i,controls:[new e.control.Zoom]});return r}function n(t,o){var n=o||{},i=n.image_vector,r=new e.source.Vector({features:(new e.format.GeoJSON).readFeatures(t)});return n.source=r,i?new e.layer.Image({source:new e.source.ImageVector(n)}):new e.layer.Vector(n)}function i(t){var o=t.positioning,n=t.autoPan,i=t.autoPanAnimation;this.hide_callback=t.hide_callback,this.show_callback=t.show_callback,this.popup_element=document.createElement("div"),this.popup_element.className="olext-popup",this.popup_title=document.createElement("p"),this.popup_title.className="olext-popup-title",this.popup_closer=document.createElement("a"),this.popup_closer.className="olext-popup-closer",this.popup_closer.href="#",this.popup_content=document.createElement("div"),this.popup_content.className="olext-popup-content",this.popup_element.appendChild(this.popup_closer),this.popup_element.appendChild(this.popup_title),this.popup_element.appendChild(this.popup_content);var r=this;this.popup_closer.addEventListener("click",function(e){r.setPosition(void 0),r.hide_callback&&r.hide_callback()}),e.Overlay.call(this,{element:this.popup_element,positioning:o,autoPan:n,autoPanAnimation:i})}return e.inherits(i,e.Overlay),i.prototype.show=function(e,t,o,n){return this.popup_title.innerHTML=t,this.popup_content.innerHTML=o,this.setPosition(e),n?n():this.show_callback&&this.show_callback(),this},i.prototype.hide=function(e){return this.setPosition(void 0),e?e():this.hide_callback&&this.hide_callback(),this},i.prototype.setTitle=function(e){this.popup_title.innerHTML=e},i.prototype.setContent=function(e){this.popup_content.innerHTML=e},{getDefaultMap:o,makeGeoJSONLayer:n,Popup:i}}),require(["jquery","ol","maps","jquery.tablesorter"],function(e,t,o){function n(){document.getElementById("preloader").style.display="none"}var i,r=o.getDefaultMap();e(document).ready(function(){function a(e){i=o.makeGeoJSONLayer(e,{style:new t.style.Style({image:new t.style.Circle({radius:5,fill:new t.style.Fill({color:"#e2bc15"}),stroke:new t.style.Stroke({color:"#fff1ae",width:1})})})}),r.addLayer(i),hover_interaction=new t.interaction.Select({condition:t.events.condition.pointerMove,layers:[i],updateWhileInteracting:!0,style:new t.style.Style({image:new t.style.Circle({radius:6,fill:new t.style.Fill({color:"#e2bc15"}),stroke:new t.style.Stroke({color:"#fff1ae",width:2})})})}),r.addInteraction(hover_interaction),l()}function l(){var n=new o.Popup({positioning:"bottom-center",autoPan:!0,autoPanAnimation:{duration:250}});r.addOverlay(n);var a=new t.interaction.Select({condition:t.events.condition.click,layers:[i]});a.on("select",function(e){var t=a.getFeatures();if(t.getLength()>0){var o=t.item(0),i=o.getGeometry().getCoordinates(),r=o.get("observer_full_name"),l=o.get("inventory_date")+" - "+o.get("location_description")+'<br><a href="'+o.get("id")+'/">Inventaire complet</a>';n.show(i,r,l)}else n.hide()}),e(".olext-popup-closer").click(function(){a.getFeatures().clear()}),r.addInteraction(a)}e("#inventories_table").tablesorter({dateFormat:"ddmmyyyy"}),e.ajax({type:"GET",url:rapid_inventory_url,success:function(e){var t=e.results;a(t),n()}})})}),define("consult_inventories",function(){});